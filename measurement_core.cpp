/**
 * ============================================================================
 * –§–ê–ô–õ: measurement_core.cpp
 * –Ø–î–†–û –ò–ó–ú–ï–†–ï–ù–ò–ô –°–ò–°–¢–ï–ú–´ –ö–û–ù–¢–†–û–õ–Ø –¢–ï–ú–ü–ï–†–ê–¢–£–†–´
 * 
 * –û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨:
 * 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–∞–º–∏ DS18B20
 * 2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –¥–∞—Ç—á–∏–∫–æ–≤
 * 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–∏ —Å –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–º–∏ –¥–∞—Ç—á–∏–∫–∞–º–∏
 * 4. –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏ FreeRTOS
 * 
 * –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –í –≠–¢–û–ô –í–ï–†–°–ò–ò:
 * 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ OneWire
 * 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–≤—è–∑—å –º–µ–∂–¥—É OneWire –∏ DallasTemperature –æ–±—ä–µ–∫—Ç–∞–º–∏
 * 3. –£–ª—É—á—à–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
 * 4. –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞ —Ä–∞–±–æ—Ç—ã
 * ============================================================================
 */

#include "measurement_core.h"

// ============================================================================
// –†–ê–ó–î–ï–õ 1: –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –û–ë–†–ê–ë–û–¢–ö–ò –î–ê–ù–ù–´–•
// ============================================================================

/**
 * –ú–ï–î–ò–ê–ù–ù–´–ô –§–ò–õ–¨–¢–† –î–õ–Ø –°–ì–õ–ê–ñ–ò–í–ê–ù–ò–Ø –ó–ù–ê–ß–ï–ù–ò–ô –¢–ï–ú–ü–ï–†–ê–¢–£–†–´
 * 
 * –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω—ã—Ö –≤—ã–±—Ä–æ—Å–æ–≤ –∏ –ø–æ–º–µ—Ö –≤ –ø–æ–∫–∞–∑–∞–Ω–∏—è—Ö –¥–∞—Ç—á–∏–∫–æ–≤
 * –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–ª—å—Ü–µ–≤–æ–π –±—É—Ñ–µ—Ä –∏–∑ 5 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
 *                 –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –ø–æ–∫–∞–∑–∞–Ω–∏–π
 * 
 * –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
 *   sensorIdx - –∏–Ω–¥–µ–∫—Å –¥–∞—Ç—á–∏–∫–∞ (0-3)
 *   newValue  - –Ω–æ–≤–æ–µ —Å—ã—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
 * 
 * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
 */
float filterValue(int sensorIdx, float newValue) {
  // –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤
  if (sensorIdx < 0 || sensorIdx >= 4) return newValue;

  // –ü–æ–ª—É—á–∞–µ–º —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞—Ç—á–∏–∫–∞ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –¥–æ—Å—Ç—É–ø–∞
  Sensor_t* s = &sensors[sensorIdx];

  // –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Å—Å–∏–≤ —Ñ–ª–∞–≥–æ–≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–∞—Ç—á–∏–∫–∞
  static bool bufferInitialized[4] = { false, false, false, false };

  // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –§–ò–õ–¨–¢–†–ê (–ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ –¥–ª—è –¥–∞—Ç—á–∏–∫–∞)
  if (!bufferInitialized[sensorIdx]) {
    // –ó–∞–ø–æ–ª–Ω—è–µ–º –≤–µ—Å—å –±—É—Ñ–µ—Ä –ø–µ—Ä–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º
    for (int j = 0; j < 5; j++) {
      s->filterBuffer[j] = newValue;
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—É–º–º—É –∏ –∏–Ω–¥–µ–∫—Å
    s->filterSum = newValue * 5.0f;  // –°—É–º–º–∞ 5 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    s->filterIndex = 0;               // –ù–∞—á–∏–Ω–∞–µ–º —Å –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –±—É—Ñ–µ—Ä–∞
    bufferInitialized[sensorIdx] = true;  // –ü–æ–º–µ—á–∞–µ–º —Ñ–∏–ª—å—Ç—Ä –∫–∞–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
    
    return newValue;  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
  }

  // –û–ë–ù–û–í–õ–ï–ù–ò–ï –§–ò–õ–¨–¢–†–ê (–ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏)
  // 1. –£–¥–∞–ª—è–µ–º —Å–∞–º–æ–µ —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å—É–º–º—ã
  s->filterSum -= s->filterBuffer[s->filterIndex];
  
  // 2. –ó–∞–º–µ–Ω—è–µ–º —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤–æ–µ –≤ –±—É—Ñ–µ—Ä–µ
  s->filterBuffer[s->filterIndex] = newValue;
  
  // 3. –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫ —Å—É–º–º–µ
  s->filterSum += newValue;
  
  // 4. –ü–µ—Ä–µ–º–µ—â–∞–µ–º –∏–Ω–¥–µ–∫—Å –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É (–∫–æ–ª—å—Ü–µ–≤–æ–π –±—É—Ñ–µ—Ä)
  s->filterIndex = (s->filterIndex + 1) % 5;

  // 5. –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (—Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ)
  return s->filterSum / 5.0f;
}

/**
 * –ü–†–û–í–ï–†–ö–ê –í–ê–õ–ò–î–ù–û–°–¢–ò –ó–ù–ê–ß–ï–ù–ò–Ø –¢–ï–ú–ü–ï–†–ê–¢–£–†–´
 * 
 * –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç –¥–∞—Ç—á–∏–∫–æ–≤
 *             (–æ—à–∏–±–∫–∏ —á—Ç–µ–Ω–∏—è, —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã)
 * 
 * –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
 *   temp - –ø—Ä–æ–≤–µ—Ä—è–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
 * 
 * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: true –µ—Å–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–∞–ª–∏–¥–Ω–∞, false –µ—Å–ª–∏ —ç—Ç–æ –æ—à–∏–±–∫–∞
 */
bool isValidTemperature(float temp) {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
  return !(temp == TEMP_NO_DATA ||         // –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è)
           temp == TEMP_SENSOR_LOST ||     // –î–∞—Ç—á–∏–∫ —Å—Ç–µ–Ω–∫–∏ –ø–æ—Ç–µ—Ä—è–Ω
           temp == TEMP_CRITICAL_LOST ||   // –î–∞—Ç—á–∏–∫ –≥–∏–ª—å–∑—ã –ø–æ—Ç–µ—Ä—è–Ω (–∫—Ä–∏—Ç–∏—á–Ω–æ!)
           temp == -999.0f ||              // –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—à–∏–±–∫–∏
           temp < -50.0f ||                // –§–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞—è –Ω–∏–∑–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
           temp > 150.0f);                 // –§–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞—è –≤—ã—Å–æ–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
}

// ============================================================================
// –†–ê–ó–î–ï–õ 2: –§–£–ù–ö–¶–ò–ò –ë–ï–ó–û–ü–ê–°–ù–û–ô –†–ê–ë–û–¢–´ –° –û–ë–©–ò–ú–ò –î–ê–ù–ù–´–ú–ò
// ============================================================================

/**
 * –ë–ï–ó–û–ü–ê–°–ù–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–ò–°–¢–ï–ú–ù–´–• –î–ê–ù–ù–´–• (—Å –∑–∞—â–∏—Ç–æ–π –º—å—é—Ç–µ–∫—Å–æ–º)
 * 
 * –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ –¥–µ–ª—å—Ç—ã –≤ –æ–±—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ sysData
 *             —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –≥–æ–Ω–∫–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏ FreeRTOS
 * 
 * –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
 *   idx   - –∏–Ω–¥–µ–∫—Å –¥–∞—Ç—á–∏–∫–∞ (0-3)
 *   temp  - –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
 *   delta - –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (ŒîT)
 */
void safeUpdateSystemData(int idx, float temp, float delta) {
  // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞—Ö–≤–∞—Ç–∏—Ç—å –º—å—é—Ç–µ–∫—Å —Å —Ç–∞–π–º–∞—É—Ç–æ–º 10 –º—Å
  if (xSemaphoreTake(dataMutex, pdMS_TO_TICKS(10)) == pdTRUE) {
    // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–∫—Ü–∏—è: –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
    sysData.temps[idx] = temp;    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É
    sysData.deltas[idx] = delta;  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–µ–ª—å—Ç—É
    
    // –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –º—å—é—Ç–µ–∫—Å –¥–ª—è –¥—Ä—É–≥–∏—Ö –∑–∞–¥–∞—á
    xSemaphoreGive(dataMutex);
  }
  // –ï—Å–ª–∏ –º—å—é—Ç–µ–∫—Å –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞—Ö–≤–∞—Ç–∏—Ç—å - –¥–∞–Ω–Ω—ã–µ –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
  // (–ª—É—á—à–µ –ø–æ—Ç–µ—Ä—è—Ç—å –æ–¥–Ω–æ –∏–∑–º–µ—Ä–µ–Ω–∏–µ, —á–µ–º –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É)
}

/**
 * –ë–ï–ó–û–ü–ê–°–ù–û–ï –ß–¢–ï–ù–ò–ï –°–ò–°–¢–ï–ú–ù–´–• –î–ê–ù–ù–´–• (—Å –∑–∞—â–∏—Ç–æ–π –º—å—é—Ç–µ–∫—Å–æ–º)
 * 
 * –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—É—é –∫–æ–ø–∏—é —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏
 *             –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏ –∏–ª–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
 * 
 * –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
 *   data - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∫—É–¥–∞ –±—É–¥—É—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ
 */
void safeReadSystemData(SystemData_t* data) {
  // –ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ–º –º—å—é—Ç–µ–∫—Å –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
  if (xSemaphoreTake(dataMutex, pdMS_TO_TICKS(10)) == pdTRUE) {
    // –ö–æ–ø–∏—Ä—É–µ–º –í–°–ï –¥–∞–Ω–Ω—ã–µ –∏–∑ sysData –≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
    memcpy(data, &sysData, sizeof(SystemData_t));
    
    // –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –º—å—é—Ç–µ–∫—Å
    xSemaphoreGive(dataMutex);
  }
}

// ============================================================================
// –†–ê–ó–î–ï–õ 3: –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò –î–ê–¢–ß–ò–ö–û–í (–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø)
// ============================================================================

/**
 * –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –°–ò–°–¢–ï–ú–´ –ò–ó–ú–ï–†–ï–ù–ò–ô - –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ú–û–î–£–õ–Ø
 * 
 * –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Å–µ—Ö –¥–∞—Ç—á–∏–∫–æ–≤ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
 *             –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
 * 
 * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: true  - —Å–∏—Å—Ç–µ–º–∞ —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ (–Ω–∞–π–¥–µ–Ω –¥–∞—Ç—á–∏–∫ –≥–∏–ª—å–∑—ã)
 *             false - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ (–¥–∞—Ç—á–∏–∫ –≥–∏–ª—å–∑—ã –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω)
 * 
 * –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ü–µ–ø–æ—á–∫–∏:
 *                         OneWire ‚Üí DallasTemperature ‚Üí begin()
 */
bool begin() {
  Serial.println("\n" + String(60, '='));
  Serial.println("üöÄ –ó–ê–ü–£–°–ö –Ø–î–†–ê –ò–ó–ú–ï–†–ï–ù–ò–ô (–£–°–ò–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø)");
  Serial.println(String(60, '='));
  
  // -------------------- –≠–¢–ê–ü 1: –ü–û–î–ì–û–¢–û–í–ö–ê –°–¢–†–£–ö–¢–£–† –î–ê–ù–ù–´–• --------------------
  Serial.println("\nüìã –≠–¢–ê–ü 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö");
  
  // –°–±—Ä–æ—Å –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Ñ–ª–∞–≥–æ–≤ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
  criticalError = false;       // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–∏
  systemInitialized = false;   // –°–∏—Å—Ç–µ–º–∞ –µ—â—ë –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞—Ç—á–∏–∫–æ–≤
  for (int i = 0; i < 4; i++) {
    sensors[i].found = false;           // –î–∞—Ç—á–∏–∫ –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω
    sensors[i].temp = TEMP_NO_DATA;     // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö"
    sensors[i].lostTimer = 0;           // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –ø–æ—Ç–µ—Ä—å
    sensors[i].filterIndex = 0;         // –°–±—Ä–æ—Å –∏–Ω–¥–µ–∫—Å–∞ —Ñ–∏–ª—å—Ç—Ä–∞
    sensors[i].filterSum = 0.0f;        // –°–±—Ä–æ—Å —Å—É–º–º—ã —Ñ–∏–ª—å—Ç—Ä–∞
    
    // –û—á–∏—Å—Ç–∫–∞ –∞–¥—Ä–µ—Å–∞ –¥–∞—Ç—á–∏–∫–∞ (8 –±–∞–π—Ç –¥–ª—è 1-Wire)
    memset(sensors[i].addr, 0, 8);
    
    // –û—á–∏—Å—Ç–∫–∞ –±—É—Ñ–µ—Ä–∞ –º–µ–¥–∏–∞–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ (5 –∑–Ω–∞—á–µ–Ω–∏–π)
    memset(sensors[i].filterBuffer, 0, sizeof(float) * 5);
  }
  
  Serial.println("‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞—Ç—á–∏–∫–æ–≤ —Å–±—Ä–æ—à–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ");
  
  // -------------------- –≠–¢–ê–ü 2: –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –®–ò–ù–´ A (–ì–ò–õ–¨–ó–ê) --------------------
  Serial.println("\n" + String(40, '-'));
  Serial.println("üîß –≠–¢–ê–ü 2: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —à–∏–Ω—ã A (GPIO4 - –î–ê–¢–ß–ò–ö –ì–ò–õ–¨–ó–´)");
  Serial.println(String(40, '-'));
  
  // –®–ê–ì 2.1: –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –û–ë–™–ï–ö–¢–ê ONEWIRE –î–õ–Ø –®–ò–ù–´ A
  // -----------------------------------------------------------------
  Serial.print("1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è OneWire –Ω–∞ GPIO4... ");
  
  // –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç OneWire –¥–ª—è —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —à–∏–Ω—ã
  // –≠—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–≤—è–∑—å –º–µ–∂–¥—É –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º GPIO –ø–∏–Ω–æ–º
  oneWireA.begin(ONE_WIRE_BUS_A);  // ONE_WIRE_BUS_A = 4 (GPIO4)
  
  delay(100);  // –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ —à–∏–Ω—ã –ø–æ—Å–ª–µ –ø–æ–¥–∞—á–∏ –ø–∏—Ç–∞–Ω–∏—è
  Serial.println("‚úÖ");
  
  // –®–ê–ì 2.2: –°–í–Ø–ó–´–í–ê–ù–ò–ï DALLAS TEMPERATURE –° ONEWIRE
  // -----------------------------------------------------------------
  Serial.print("2. –°–≤—è–∑—ã–≤–∞–Ω–∏–µ DallasTemperature —Å OneWire... ");
  
  // –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ù—É–∂–Ω–æ —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å DallasTemperature, –∫–∞–∫–æ–π –æ–±—ä–µ–∫—Ç
  // OneWire –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å. –ë–µ–∑ —ç—Ç–æ–≥–æ sensorsA –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —à–∏–Ω–æ–π!
  sensorsA.setOneWire(&oneWireA);  // –°–≤—è–∑—ã–≤–∞–µ–º sensorsA —Å oneWireA
  
  Serial.println("‚úÖ");
  
  // –®–ê–ì 2.3: –ó–ê–ü–£–°–ö –ë–ò–ë–õ–ò–û–¢–ï–ö–ò DALLAS TEMPERATURE
  // -----------------------------------------------------------------
  Serial.print("3. –ó–∞–ø—É—Å–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ DallasTemperature... ");
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ DallasTemperature
  sensorsA.begin();
  
  delay(100);  // –î–∞—ë–º –≤—Ä–µ–º—è –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
  Serial.println("‚úÖ");
  
  // –®–ê–ì 2.4: –ü–û–ò–°–ö –£–°–¢–†–û–ô–°–¢–í –ù–ê –®–ò–ù–ï A
  // -----------------------------------------------------------------
  Serial.print("4. –ü–æ–∏—Å–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –Ω–∞ —à–∏–Ω–µ A... ");
  
  // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –Ω–∞ —à–∏–Ω–µ
  int countA = sensorsA.getDeviceCount();
  Serial.printf("–Ω–∞–π–¥–µ–Ω–æ: %d —É—Å—Ç—Ä–æ–π—Å—Ç–≤\n", countA);
  
  // –û–ë–†–ê–ë–û–¢–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –ü–û–ò–°–ö–ê –ù–ê –®–ò–ù–ï A
  if (countA > 0) {
    // –£–°–ü–ï–•: –ù–∞ —à–∏–Ω–µ –Ω–∞–π–¥–µ–Ω—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
    
    // –ü–æ–ª—É—á–∞–µ–º –∞–¥—Ä–µ—Å –ø–µ—Ä–≤–æ–≥–æ (–∏ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ) –¥–∞—Ç—á–∏–∫–∞ –Ω–∞ —à–∏–Ω–µ A
    DeviceAddress tempAddr;  // –í—Ä–µ–º–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –∞–¥—Ä–µ—Å–∞
    if (sensorsA.getAddress(tempAddr, 0)) {
      // –ö–æ–ø–∏—Ä—É–µ–º 8-–±–∞–π—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞—Ç—á–∏–∫–∞ –≥–∏–ª—å–∑—ã (–∏–Ω–¥–µ–∫—Å 3)
      memcpy(sensors[3].addr, tempAddr, 8);
      
      // –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ "–Ω–∞–π–¥–µ–Ω"!
      // –ë–µ–∑ —ç—Ç–æ–≥–æ —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç —Å—á–∏—Ç–∞—Ç—å –¥–∞—Ç—á–∏–∫ –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–º
      sensors[3].found = true;
      
      // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–∞ (11 –±–∏—Ç = —Ç–æ—á–Ω–æ—Å—Ç—å 0.125¬∞C)
      sensorsA.setResolution(tempAddr, RESOLUTION);
      
      // –í—ã–≤–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞–π–¥–µ–Ω–Ω–æ–º –¥–∞—Ç—á–∏–∫–µ
      Serial.print("   ‚úÖ –î–ê–¢–ß–ò–ö –ì–ò–õ–¨–ó–´ –ù–ê–ô–î–ï–ù! –ê–¥—Ä–µ—Å: ");
      for (int i = 0; i < 8; i++) {
        Serial.printf("%02X", tempAddr[i]);
        if (i < 7) Serial.print(":");
      }
      Serial.println();
    }
  } else {
    // –û–®–ò–ë–ö–ê: –ù–∞ —à–∏–Ω–µ A –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
    Serial.println("   ‚ùå –ù–ê –®–ò–ù–ï A –£–°–¢–†–û–ô–°–¢–í–ê –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–´");
    
    // –î–ï–¢–ê–õ–¨–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê: –ü—Ä–æ–≤–µ—Ä—è–µ–º —à–∏–Ω—É –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ OneWire
    Serial.println("   üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —à–∏–Ω—ã A:");
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º reset pulse –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º presence pulse
    oneWireA.reset();
    delayMicroseconds(480);  // –û–∂–∏–¥–∞–µ–º –æ—Ç–≤–µ—Ç–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
    byte presence = oneWireA.read();  // –ß–∏—Ç–∞–µ–º –æ—Ç–≤–µ—Ç
    
    Serial.printf("     - Presence pulse: %s\n", 
                  presence == 0 ? "‚úÖ –û–ë–ù–ê–†–£–ñ–ï–ù" : "‚ùå –û–¢–°–£–¢–°–¢–í–£–ï–¢");
    
    if (presence != 0) {
      Serial.println("     ‚ö†Ô∏è  –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ß–ò–ù–´:");
      Serial.println("       1. –î–∞—Ç—á–∏–∫ –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω –∫ GPIO4 (–ø–∏–Ω 29)");
      Serial.println("       2. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–∏—Ç–∞–Ω–∏–µ 3.3V –Ω–∞ –¥–∞—Ç—á–∏–∫–µ");
      Serial.println("       3. –ù–µ—Ç –ø–æ–¥—Ç—è–≥–∏–≤–∞—é—â–µ–≥–æ —Ä–µ–∑–∏—Å—Ç–æ—Ä–∞ 4.7–∫–û–º");
      Serial.println("       4. –î–∞—Ç—á–∏–∫ –ø–æ–¥–∫–ª—é—á—ë–Ω –∫ –¥—Ä—É–≥–æ–º—É GPIO");
      Serial.println("       5. –ù–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—å –¥–∞—Ç—á–∏–∫–∞ –∏–ª–∏ –ø—Ä–æ–≤–æ–¥–æ–≤");
    }
  }
  
  // -------------------- –≠–¢–ê–ü 3: –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –®–ò–ù–´ B (–°–¢–ï–ù–ö–ò) --------------------
  Serial.println("\n" + String(40, '-'));
  Serial.println("üîß –≠–¢–ê–ü 3: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —à–∏–Ω—ã B (GPIO16 - –î–ê–¢–ß–ò–ö–ò –°–¢–ï–ù–û–ö)");
  Serial.println(String(40, '-'));
  
  // –®–ê–ì 3.1: –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –û–ë–™–ï–ö–¢–ê ONEWIRE –î–õ–Ø –®–ò–ù–´ B
  // -----------------------------------------------------------------
  Serial.print("1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è OneWire –Ω–∞ GPIO16... ");
  
  // –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —à–∏–Ω–µ A: —Å–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç –¥–ª—è –≤—Ç–æ—Ä–æ–π —à–∏–Ω—ã
  oneWireB.begin(ONE_WIRE_BUS_B);  // ONE_WIRE_BUS_B = 16 (GPIO16)
  
  delay(100);
  Serial.println("‚úÖ");
  
  // –®–ê–ì 3.2: –°–í–Ø–ó–´–í–ê–ù–ò–ï DALLAS TEMPERATURE –° ONEWIRE
  // -----------------------------------------------------------------
  Serial.print("2. –°–≤—è–∑—ã–≤–∞–Ω–∏–µ DallasTemperature —Å OneWire... ");
  
  sensorsB.setOneWire(&oneWireB);  // –°–≤—è–∑—ã–≤–∞–µ–º sensorsB —Å oneWireB
  
  Serial.println("‚úÖ");
  
  // –®–ê–ì 3.3: –ó–ê–ü–£–°–ö –ë–ò–ë–õ–ò–û–¢–ï–ö–ò DALLAS TEMPERATURE
  // -----------------------------------------------------------------
  Serial.print("3. –ó–∞–ø—É—Å–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ DallasTemperature... ");
  
  sensorsB.begin();
  
  delay(100);
  Serial.println("‚úÖ");
  
  // –®–ê–ì 3.4: –ü–û–ò–°–ö –£–°–¢–†–û–ô–°–¢–í –ù–ê –®–ò–ù–ï B
  // -----------------------------------------------------------------
  Serial.print("4. –ü–æ–∏—Å–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –Ω–∞ —à–∏–Ω–µ B... ");
  
  int countB = sensorsB.getDeviceCount();
  Serial.printf("–Ω–∞–π–¥–µ–Ω–æ: %d —É—Å—Ç—Ä–æ–π—Å—Ç–≤\n", countB);
  
  // –û–ë–†–ê–ë–û–¢–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –ü–û–ò–°–ö–ê –ù–ê –®–ò–ù–ï B
  if (countB > 0) {
    // –£–°–ü–ï–•: –ù–∞ —à–∏–Ω–µ B –Ω–∞–π–¥–µ–Ω—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (—Å—Ç–µ–Ω–∫–∏)
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–∫–æ–ª—å–∫–æ –¥–∞—Ç—á–∏–∫–æ–≤ —Ä–µ–∞–ª—å–Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å
    int devicesToRead = min(countB, 3);  // –ú–∞–∫—Å–∏–º—É–º 3 –¥–∞—Ç—á–∏–∫–∞ —Å—Ç–µ–Ω–æ–∫
    
    // –ú–∞—Å—Å–∏–≤ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤
    DeviceAddress foundAddrs[3];
    
    Serial.printf("   üìä –ß—Ç–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤ %d –¥–∞—Ç—á–∏–∫–æ–≤...\n", devicesToRead);
    
    for (int i = 0; i < devicesToRead; i++) {
      // –ü–æ–ª—É—á–∞–µ–º –∞–¥—Ä–µ—Å i-–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞ —à–∏–Ω–µ
      if (sensorsB.getAddress(foundAddrs[i], i)) {
        // –ü–†–û–°–¢–ê–Ø –°–•–ï–ú–ê –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–Ø: 
        // –ü–µ—Ä–≤—ã–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π ‚Üí –ø–µ—Ä–≤—ã–π –¥–∞—Ç—á–∏–∫ (–∏–Ω–¥–µ–∫—Å 0)
        // –í—Ç–æ—Ä–æ–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π ‚Üí –≤—Ç–æ—Ä–æ–π –¥–∞—Ç—á–∏–∫ (–∏–Ω–¥–µ–∫—Å 1)  
        // –¢—Ä–µ—Ç–∏–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π ‚Üí —Ç—Ä–µ—Ç–∏–π –¥–∞—Ç—á–∏–∫ (–∏–Ω–¥–µ–∫—Å 2)
        int sensorIndex = i;  // 0, 1 –∏–ª–∏ 2
        
        // –ö–æ–ø–∏—Ä—É–µ–º –∞–¥—Ä–µ—Å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞—Ç—á–∏–∫–∞
        memcpy(sensors[sensorIndex].addr, foundAddrs[i], 8);
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ "–Ω–∞–π–¥–µ–Ω" –¥–ª—è –¥–∞—Ç—á–∏–∫–∞ —Å—Ç–µ–Ω–∫–∏
        sensors[sensorIndex].found = true;
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–∞
        sensorsB.setResolution(foundAddrs[i], RESOLUTION);
        
        // –í—ã–≤–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞–π–¥–µ–Ω–Ω–æ–º –¥–∞—Ç—á–∏–∫–µ
        Serial.printf("   ‚úÖ %s –Ω–∞–π–¥–µ–Ω –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω\n", 
                      sensorNames[sensorIndex]);
      }
    }
  } else {
    // –û–®–ò–ë–ö–ê: –ù–∞ —à–∏–Ω–µ B –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
    Serial.println("   ‚ùå –ù–ê –®–ò–ù–ï B –£–°–¢–†–û–ô–°–¢–í–ê –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–´");
    
    // –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —à–∏–Ω—ã B
    Serial.println("   üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —à–∏–Ω—ã B:");
    
    oneWireB.reset();
    delayMicroseconds(480);
    byte presence = oneWireB.read();
    
    Serial.printf("     - Presence pulse: %s\n",
                  presence == 0 ? "‚úÖ –û–ë–ù–ê–†–£–ñ–ï–ù" : "‚ùå –û–¢–°–£–¢–°–¢–í–£–ï–¢");
  }
  
  // -------------------- –≠–¢–ê–ü 4: –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –ò –£–°–¢–ê–ù–û–í–ö–ê –§–õ–ê–ì–û–í --------------------
  Serial.println("\n" + String(50, '-'));
  Serial.println("üìä –≠–¢–ê–ü 4: –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏");
  Serial.println(String(50, '-'));
  
  // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–∫–æ–ª—å–∫–æ –¥–∞—Ç—á–∏–∫–æ–≤ —É—Å–ø–µ—à–Ω–æ –Ω–∞–π–¥–µ–Ω–æ
  int foundCount = 0;
  for (int i = 0; i < 4; i++) {
    if (sensors[i].found) {
      foundCount++;
      Serial.printf("   [%d] %s: ‚úÖ –ù–ê–ô–î–ï–ù\n", i, sensorNames[i]);
    } else {
      Serial.printf("   [%d] %s: ‚ùå –ù–ï –ù–ê–ô–î–ï–ù\n", i, sensorNames[i]);
    }
  }
  
  // -------------------- –≠–¢–ê–ü 5: –ü–†–û–í–ï–†–ö–ê –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –£–°–õ–û–í–ò–ô --------------------
  Serial.println("\n" + String(40, '='));
  Serial.println("‚ö° –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê –°–ò–°–¢–ï–ú–´");
  Serial.println(String(40, '='));
  
  // –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –£–°–õ–û–í–ò–ï: –î–ê–¢–ß–ò–ö –ì–ò–õ–¨–ó–´ –î–û–õ–ñ–ï–ù –ë–´–¢–¨ –ù–ê–ô–î–ï–ù!
  if (sensors[3].found) {
    // –£–°–ü–ï–•: –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
    Serial.println("‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –î–ê–¢–ß–ò–ö (–ì–ò–õ–¨–ó–ê) –ù–ê–ô–î–ï–ù!");
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–ª–∞–≥–∏ –≤ —Ä–∞–±–æ—á–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    criticalError = false;      // –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
    systemInitialized = true;   // –°–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–∞–∑–æ–≤—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –≥–∏–ª—å–∑—ã –¥–ª—è —Ä–µ–∂–∏–º–∞ MODE2
    // (–∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –µ—â—ë –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º)
    if (guildBaseTemp == 0.0f) {
      guildBaseTemp = 20.0f;  // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20¬∞C
      Serial.printf("   –ë–∞–∑–æ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≥–∏–ª—å–∑—ã: %.1f¬∞C (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)\n", 
                    guildBaseTemp);
    }
    
    Serial.println("\nüéâ –°–ò–°–¢–ï–ú–ê –£–°–ü–ï–®–ù–û –ò–ù–ò–¶–ò–ê–õ–ò–ó–ò–†–û–í–ê–ù–ê –ò –ì–û–¢–û–í–ê –ö –†–ê–ë–û–¢–ï!");
  } else {
    // –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: –°–∏—Å—Ç–µ–º–∞ –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –¥–∞—Ç—á–∏–∫–∞ –≥–∏–ª—å–∑—ã
    Serial.println("‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: –î–ê–¢–ß–ò–ö –ì–ò–õ–¨–ó–´ –ù–ï –ù–ê–ô–î–ï–ù!");
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥–∏ –æ—à–∏–±–∫–∏
    criticalError = true;       // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞!
    systemInitialized = false;  // –°–∏—Å—Ç–µ–º–∞ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
    
    Serial.println("\nüö® –°–ò–°–¢–ï–ú–ê –ù–ï –ú–û–ñ–ï–¢ –†–ê–ë–û–¢–ê–¢–¨ –ë–ï–ó –î–ê–¢–ß–ò–ö–ê –ì–ò–õ–¨–ó–´!");
    Serial.println("   –í–æ–∑–º–æ–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:");
    Serial.println("   1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–∞ –≥–∏–ª—å–∑—ã –∫ GPIO4");
    Serial.println("   2. –í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É FIND –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞");
    Serial.println("   3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∂–∏–º —Ç–µ—Å—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞");
  }
  
  // -------------------- –≠–¢–ê–ü 6: –§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–Å–¢ --------------------
  Serial.printf("\nüìà –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê: –ù–∞–π–¥–µ–Ω–æ –¥–∞—Ç—á–∏–∫–æ–≤ %d –∏–∑ 4\n", foundCount);
  Serial.println(String(60, '=') + "\n");
  
  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
  return systemInitialized;
}

// ============================================================================
// –†–ê–ó–î–ï–õ 4: –§–£–ù–ö–¶–ò–Ø –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ì–û –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–Ø –î–ê–¢–ß–ò–ö–û–í
// ============================================================================

/**
 * –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –ü–û–¢–ï–†–Ø–ù–ù–´–• –î–ê–¢–ß–ò–ö–û–í
 * 
 * –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—ã—Ç–∞—Ç—å—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–≤—è–∑—å —Å –¥–∞—Ç—á–∏–∫–∞–º–∏,
 *             –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ "–ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ" (found = false)
 *             –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ –∑–∞–¥–∞—á–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π –ø–æ —Ç–∞–π–º–µ—Ä—É
 * 
 * –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
 * - –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –ø—Ä–∏ systemInitialized = false
 * - –ú–æ–∂–µ—Ç —á–∞—Å—Ç–∏—á–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É
 * - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
 */
void attemptReconnect() {
  Serial.println("\n" + String(50, '-'));
  Serial.println("üîÑ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –î–ê–¢–ß–ò–ö–û–í");
  Serial.println(String(50, '-'));
  
  bool reconnectedAny = false;  // –§–ª–∞–≥: —É–¥–∞–ª–æ—Å—å –ª–∏ —á—Ç–æ-—Ç–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
  
  // -------------------- –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –®–ò–ù–´ A (–ì–ò–õ–¨–ó–ê) --------------------
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –¥–∞—Ç—á–∏–∫ –≥–∏–ª—å–∑—ã –ø–æ—Ç–µ—Ä—è–Ω
  if (!sensors[3].found) {
    Serial.println("üîç –ü–æ–∏—Å–∫ –¥–∞—Ç—á–∏–∫–∞ –≥–∏–ª—å–∑—ã –Ω–∞ —à–∏–Ω–µ A...");
    
    // –í–ê–ñ–ù–û: –ü–æ–ª–Ω–∞—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —à–∏–Ω—ã
    oneWireA.begin(ONE_WIRE_BUS_A);      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è OneWire
    sensorsA.setOneWire(&oneWireA);      // –°–≤—è–∑—ã–≤–∞–Ω–∏–µ —Å DallasTemperature
    sensorsA.begin();                    // –ó–∞–ø—É—Å–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
    
    delay(200);  // –î–∞—ë–º –≤—Ä–µ–º—è –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
    int countA = sensorsA.getDeviceCount();
    
    if (countA > 0) {
      // –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞–π–¥–µ–Ω—ã - –ø—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –∞–¥—Ä–µ—Å
      DeviceAddress tempAddr;
      if (sensorsA.getAddress(tempAddr, 0)) {
        // –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –£–°–ü–ï–®–ù–û!
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞–¥—Ä–µ—Å
        memcpy(sensors[3].addr, tempAddr, 8);
        
        // –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ "–Ω–∞–π–¥–µ–Ω"
        sensors[3].found = true;
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –¥–∞—Ç—á–∏–∫
        sensorsA.setResolution(tempAddr, RESOLUTION);
        sensors[3].lostTimer = 0;  // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –ø–æ—Ç–µ—Ä—å
        
        Serial.println("   ‚úÖ –î–ê–¢–ß–ò–ö –ì–ò–õ–¨–ó–´ –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò!");
        reconnectedAny = true;
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –≥–∏–ª—å–∑—É
        criticalError = false;
      }
    } else {
      Serial.println("   ‚ùå –ù–∞ —à–∏–Ω–µ A —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã");
    }
  }
  
  // -------------------- –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –®–ò–ù–´ B (–°–¢–ï–ù–ö–ò) --------------------
  // –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —à–∏–Ω—É B, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∞—Ç—á–∏–∫–∏ —É–∂–µ –Ω–∞–π–¥–µ–Ω—ã
  Serial.println("üîç –ü–æ–∏—Å–∫ –¥–∞—Ç—á–∏–∫–æ–≤ —Å—Ç–µ–Ω–∫–∏ –Ω–∞ —à–∏–Ω–µ B...");
  
  // –ü–æ–ª–Ω–∞—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —à–∏–Ω—ã B
  oneWireB.begin(ONE_WIRE_BUS_B);
  sensorsB.setOneWire(&oneWireB);
  sensorsB.begin();
  
  delay(200);
  
  int countB = sensorsB.getDeviceCount();
  
  if (countB > 0) {
    // –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞–π–¥–µ–Ω—ã –Ω–∞ —à–∏–Ω–µ B
    
    // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
    DeviceAddress foundAddrs[3];
    int devicesToCheck = min(countB, 3);  // –ú–∞–∫—Å–∏–º—É–º 3 –¥–∞—Ç—á–∏–∫–∞
    
    for (int i = 0; i < devicesToCheck; i++) {
      sensorsB.getAddress(foundAddrs[i], i);
    }
    
    // –ü—ã—Ç–∞–µ–º—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞–∂–¥—ã–π –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–π –¥–∞—Ç—á–∏–∫ —Å—Ç–µ–Ω–∫–∏
    for (int wallIdx = 0; wallIdx < 3; wallIdx++) {
      if (!sensors[wallIdx].found && devicesToCheck > 0) {
        // –ü—Ä–æ—Å—Ç–∞—è —Å—Ö–µ–º–∞ –ø—Ä–∏–≤—è–∑–∫–∏: —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
        int addrIdx = (wallIdx + 1) % devicesToCheck;
        
        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞—Ç—á–∏–∫
        memcpy(sensors[wallIdx].addr, foundAddrs[addrIdx], 8);
        sensors[wallIdx].found = true;
        sensorsB.setResolution(foundAddrs[addrIdx], RESOLUTION);
        sensors[wallIdx].lostTimer = 0;
        
        Serial.printf("   ‚úÖ %s –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!\n", sensorNames[wallIdx]);
        reconnectedAny = true;
      }
    }
  } else {
    Serial.println("   ‚ùå –ù–∞ —à–∏–Ω–µ B —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã");
  }
  
  // -------------------- –ò–¢–û–ì–ò –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–Ø --------------------
  Serial.println("\n" + String(40, '-'));
  Serial.println("üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–Ø");
  
  if (reconnectedAny) {
    Serial.println("‚úÖ –ê–í–¢–û–í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û –£–°–ü–ï–®–ù–û");
    
    // –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ —Ç–µ–ø–µ—Ä—å –µ—Å—Ç—å –≥–∏–ª—å–∑–∞ - —Å–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
    if (sensors[3].found) {
      systemInitialized = true;
      criticalError = false;
      Serial.println("   üìà –°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ (–≥–∏–ª—å–∑–∞ –Ω–∞–π–¥–µ–Ω–∞)");
    }
    
    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏—Å–ø–ª–µ—è
    forceDisplayRedraw = true;
    Serial.println("   üñ•Ô∏è  –î–∏—Å–ø–ª–µ–π –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—ë–Ω");
  } else {
    Serial.println("‚ùå –ù–ï –£–î–ê–õ–û–°–¨ –í–û–°–°–¢–ê–ù–û–í–ò–¢–¨ –ù–ò –û–î–ò–ù –î–ê–¢–ß–ò–ö");
    Serial.println("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–æ–≤");
  }
  
  Serial.println(String(50, '-') + "\n");
}

// ============================================================================
// –†–ê–ó–î–ï–õ 5: –°–õ–£–ñ–ï–ë–ù–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –û–¢–õ–ê–î–ö–ò –ò –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø
// ============================================================================

/**
 * –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–ê–Ø –£–°–¢–ê–ù–û–í–ö–ê –î–ê–¢–ß–ò–ö–ê –ö–ê–ö "–ù–ê–ô–î–ï–ù–ù–û–ì–û" (–î–õ–Ø –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø)
 * 
 * –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞—Ç—á–∏–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
 *             –∫–æ–≥–¥–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –¥–∞—Ç—á–∏–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–ª–∏ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω—ã
 * 
 * –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∏—Å–ø–ª–µ—è,
 *                –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã –±–µ–∑ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–π —á–∞—Å—Ç–∏
 * 
 * –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
 *   sensorIdx - –∏–Ω–¥–µ–∫—Å –¥–∞—Ç—á–∏–∫–∞ –¥–ª—è —ç–º—É–ª—è—Ü–∏–∏ (0-3)
 *   fakeTemp  - —Ç–µ—Å—Ç–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è —ç–º—É–ª—è—Ü–∏–∏
 */
void forceSensorFound(int sensorIdx, float fakeTemp) {
  // –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤
  if (sensorIdx < 0 || sensorIdx >= 4) return;
  
  Serial.printf("\n[–¢–ï–°–¢] –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–∞—Ç—á–∏–∫–∞ %s\n", 
                sensorNames[sensorIdx]);
  
  // 1. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ "–Ω–∞–π–¥–µ–Ω"
  sensors[sensorIdx].found = true;
  
  // 2. –°–æ–∑–¥–∞—ë–º —Ç–µ—Å—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å Dallas (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 0x28)
  sensors[sensorIdx].addr[0] = 0x28;  // –°–µ–º–µ–π—Å—Ç–≤–æ Dallas
  sensors[sensorIdx].addr[1] = 0xAA;  // –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –±–∞–π—Ç—ã
  sensors[sensorIdx].addr[2] = 0xBB;
  sensors[sensorIdx].addr[3] = 0xCC;
  sensors[sensorIdx].addr[4] = 0xDD;
  sensors[sensorIdx].addr[5] = 0xEE;
  sensors[sensorIdx].addr[6] = 0xFF;
  sensors[sensorIdx].addr[7] = 0x10 + sensorIdx;  // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥
  
  // 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ—Å—Ç–æ–≤—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É
  sensors[sensorIdx].temp = fakeTemp;
  
  // 4. –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –ø–æ—Ç–µ—Ä—å
  sensors[sensorIdx].lostTimer = 0;
  
  // 5. –û–±–Ω–æ–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Å –∑–∞—â–∏—Ç–æ–π –º—å—é—Ç–µ–∫—Å–æ–º)
  safeUpdateSystemData(sensorIdx, fakeTemp, 0.0f);
  
  // 6. –û–°–û–ë–ê–Ø –û–ë–†–ê–ë–û–¢–ö–ê –î–õ–Ø –î–ê–¢–ß–ò–ö–ê –ì–ò–õ–¨–ó–´ (–∏–Ω–¥–µ–∫—Å 3)
  if (sensorIdx == 3) {
    // –î–∞—Ç—á–∏–∫ –≥–∏–ª—å–∑—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω - –æ–±–Ω–æ–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–ª–∞–≥–∏
    criticalError = false;
    systemInitialized = true;
    
    Serial.printf("[–¢–ï–°–¢] ‚úÖ –î–∞—Ç—á–∏–∫ –≥–∏–ª—å–∑—ã –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω\n");
    Serial.printf("       üìè –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: %.1f¬∞C\n", fakeTemp);
    Serial.println("       ‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –†–µ–∂–∏–º —Ç–µ—Å—Ç–∞, –¥–∞—Ç—á–∏–∫ —ç–º—É–ª–∏—Ä–æ–≤–∞–Ω!");
  } else {
    // –î–ª—è –¥–∞—Ç—á–∏–∫–æ–≤ —Å—Ç–µ–Ω–æ–∫ - –ø—Ä–æ—Å—Ç–æ –ª–æ–≥–∏—Ä—É–µ–º
    Serial.printf("[–¢–ï–°–¢] ‚úÖ %s –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω\n", 
                  sensorNames[sensorIdx]);
    Serial.printf("       üìè –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: %.1f¬∞C\n", fakeTemp);
  }
}

// ============================================================================
// –ö–û–ù–ï–¶ –§–ê–ô–õ–ê measurement_core.cpp
// ============================================================================